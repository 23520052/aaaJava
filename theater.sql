CREATE TABLE KHACH_HANG (
    MA_KH VARCHAR2(50) PRIMARY KEY,
    TEN_KH VARCHAR2(100),
    EMAIL VARCHAR2(100) UNIQUE,
    SDT VARCHAR2(20),
    MAT_KHAU VARCHAR2(100),
    DIA_CHI VARCHAR2(200)
);

CREATE TABLE GHE (
    MA_GHE VARCHAR2(50) PRIMARY KEY,
    MA_PHONG VARCHAR2(50),
    HANG VARCHAR2(5),
    COT NUMBER,
    LOAI_GHE VARCHAR2(50),
    TRANG_THAI VARCHAR2(50),
    CONSTRAINT FK_GHE_PHONG FOREIGN KEY (MA_PHONG) REFERENCES PHONG_CHIEU(MA_PHONG),
    CONSTRAINT FK_GHE_LOAI_GHE FOREIGN KEY (LOAI_GHE) REFERENCES GIA_GHE(LOAI_GHE)
);

CREATE TABLE SUAT_CHIEU (
    MA_SUAT VARCHAR2(50) PRIMARY KEY,
    MA_PHIM VARCHAR2(50),
    MA_PHONG VARCHAR2(50),
    NGAY_CHIEU DATE,
    GIO_CHIEU VARCHAR2(20),
    CONSTRAINT FK_SUAT_CHIEU_PHIM FOREIGN KEY (MA_PHIM) REFERENCES PHIM(MA_PHIM),
    CONSTRAINT FK_SUAT_CHIEU_PHONG FOREIGN KEY (MA_PHONG) REFERENCES PHONG_CHIEU(MA_PHONG)
);

CREATE TABLE DAT_CHO (
    MA_DAT VARCHAR2(50) PRIMARY KEY,
    MA_KH VARCHAR2(50),
    MA_SUAT VARCHAR2(50),
    MA_GHE VARCHAR2(50),
    NGAY_DAT DATE,
    CONSTRAINT FK_DAT_CHO_KH FOREIGN KEY (MA_KH) REFERENCES KHACH_HANG(MA_KH),
    CONSTRAINT FK_DAT_CHO_SUAT FOREIGN KEY (MA_SUAT) REFERENCES SUAT_CHIEU(MA_SUAT),
    CONSTRAINT FK_DAT_CHO_GHE FOREIGN KEY (MA_GHE) REFERENCES GHE(MA_GHE)
);

CREATE TABLE THANH_TOAN (
    MA_THANH_TOAN VARCHAR2(50) PRIMARY KEY,
    MA_DAT VARCHAR2(50) UNIQUE,
    PHUONG_THUC VARCHAR2(50),
    TONG_TIEN NUMBER(15, 2),
    NGAY_THANH_TOAN DATE,
    CONSTRAINT FK_THANH_TOAN_DAT FOREIGN KEY (MA_DAT) REFERENCES DAT_CHO(MA_DAT)
);

CREATE TABLE PHIM (
    MA_PHIM VARCHAR2(10) PRIMARY KEY,
    TEN_PHIM VARCHAR2(100),
    DAO_DIEN VARCHAR2(100),
    THE_LOAI VARCHAR2(50),
    THOI_LUONG NUMBER, -- đơn vị: phút
    MO_TA VARCHAR2(500)
);

CREATE TABLE PHONG_CHIEU (
    MA_PHONG VARCHAR2(10) PRIMARY KEY,
    TEN_PHONG VARCHAR2(50),
    SO_GHE NUMBER
);

CREATE TABLE NHANVIEN (
    MA_NV VARCHAR2(10) PRIMARY KEY,
    TEN_NV VARCHAR2(100),
    EMAIL VARCHAR2(100) UNIQUE,
    SDT VARCHAR2(15),
    MAT_KHAU VARCHAR2(100),
    CHUC_VU VARCHAR2(20) -- 'ADMIN', 'NHAN_VIEN'
);

CREATE TABLE GIA_GHE (
    LOAI_GHE VARCHAR2(20) PRIMARY KEY,
    GIA NUMBER
);

-- CHI TIẾT ĐẶT CHỖ (nếu đặt 1 lượt nhiều ghế)
CREATE TABLE CHI_TIET_DAT_CHO (
    MA_DAT VARCHAR2(50),
    MA_GHE VARCHAR2(50),
    GIA NUMBER,
    PRIMARY KEY (MA_DAT, MA_GHE),
    FOREIGN KEY (MA_DAT) REFERENCES DAT_CHO(MA_DAT),
    FOREIGN KEY (MA_GHE) REFERENCES GHE(MA_GHE)
);

ALTER TABLE DAT_CHO MODIFY NGAY_DAT TIMESTAMP;


INSERT INTO KHACH_HANG VALUES ('KH001', 'Nguyễn Văn A', 'a@gmail.com', '0912345678', 'pass123', 'Hà Nội');
INSERT INTO KHACH_HANG VALUES ('KH002', 'Trần Thị B', 'b@gmail.com', '0912345679', 'pass234', 'Hồ Chí Minh');
INSERT INTO KHACH_HANG VALUES ('KH003', 'Lê Văn C', 'c@gmail.com', '0912345680', 'pass345', 'Đà Nẵng');
INSERT INTO KHACH_HANG VALUES ('KH004', 'Phạm Thị D', 'd@gmail.com', '0912345681', 'pass456', 'Cần Thơ');
INSERT INTO KHACH_HANG VALUES ('KH005', 'Hoàng Văn E', 'e@gmail.com', '0912345682', 'pass567', 'Huế');

INSERT INTO PHIM VALUES ('P01', 'Avengers: Endgame', 'Anthony Russo', 'Hành động', 180, 'Cuộc chiến cuối cùng của Avengers');
INSERT INTO PHIM VALUES ('P02', 'Inception', 'Christopher Nolan', 'Khoa học viễn tưởng', 148, 'Giấc mơ trong giấc mơ');
INSERT INTO PHIM VALUES ('P03', 'Parasite', 'Bong Joon-ho', 'Tâm lý', 132, 'Gia đình ký sinh');
INSERT INTO PHIM VALUES ('P04', 'The Lion King', 'Jon Favreau', 'Hoạt hình', 118, 'Cuộc sống hoang dã của Simba');
INSERT INTO PHIM VALUES ('P05', 'Joker', 'Todd Phillips', 'Tâm lý', 122, 'Sự biến đổi của Arthur Fleck');

INSERT INTO PHONG_CHIEU VALUES ('PC01', 'Phòng 1', 100);
INSERT INTO PHONG_CHIEU VALUES ('PC02', 'Phòng 2', 80);
INSERT INTO PHONG_CHIEU VALUES ('PC03', 'Phòng 3', 120);
INSERT INTO PHONG_CHIEU VALUES ('PC04', 'Phòng 4', 60);
INSERT INTO PHONG_CHIEU VALUES ('PC05', 'Phòng 5', 90);

INSERT INTO GIA_GHE VALUES ('THUONG', 60000);
INSERT INTO GIA_GHE VALUES ('VIP', 90000);
INSERT INTO GIA_GHE VALUES ('DOI', 120000);
INSERT INTO GIA_GHE VALUES ('SIEU_VIP', 150000);
INSERT INTO GIA_GHE VALUES ('ECONOMY', 45000);

INSERT INTO GHE VALUES ('A1', 'PC01', 'A', 1, 'THUONG', 'TRONG');
INSERT INTO GHE VALUES ('A2', 'PC01', 'A', 2, 'THUONG', 'TRONG');
INSERT INTO GHE VALUES ('A3', 'PC01', 'A', 3, 'VIP', 'TRONG');
INSERT INTO GHE VALUES ('A4', 'PC01', 'A', 4, 'DOI', 'TRONG');
INSERT INTO GHE VALUES ('A5', 'PC01', 'A', 5, 'VIP', 'TRONG');

INSERT INTO SUAT_CHIEU VALUES ('SC01', 'P01', 'PC01', TO_DATE('2025-05-10', 'YYYY-MM-DD'), '18:30');
INSERT INTO SUAT_CHIEU VALUES ('SC02', 'P02', 'PC02', TO_DATE('2025-05-10', 'YYYY-MM-DD'), '20:00');
INSERT INTO SUAT_CHIEU VALUES ('SC03', 'P03', 'PC03', TO_DATE('2025-05-11', 'YYYY-MM-DD'), '17:00');
INSERT INTO SUAT_CHIEU VALUES ('SC04', 'P04', 'PC04', TO_DATE('2025-05-12', 'YYYY-MM-DD'), '15:00');
INSERT INTO SUAT_CHIEU VALUES ('SC05', 'P05', 'PC05', TO_DATE('2025-05-13', 'YYYY-MM-DD'), '21:00');

INSERT INTO DAT_CHO VALUES ('D001', 'KH001', 'SC01', 'A1', TO_DATE('2025-05-09', 'YYYY-MM-DD'));
INSERT INTO DAT_CHO VALUES ('D002', 'KH002', 'SC01', 'A2', TO_DATE('2025-05-09', 'YYYY-MM-DD'));
INSERT INTO DAT_CHO VALUES ('D003', 'KH003', 'SC02', 'A3', TO_DATE('2025-05-09', 'YYYY-MM-DD'));
INSERT INTO DAT_CHO VALUES ('D004', 'KH004', 'SC03', 'A4', TO_DATE('2025-05-09', 'YYYY-MM-DD'));
INSERT INTO DAT_CHO VALUES ('D005', 'KH005', 'SC04', 'A5', TO_DATE('2025-05-09', 'YYYY-MM-DD'));

INSERT INTO THANH_TOAN VALUES ('TT001', 'D001', 'VNPAY', 60000, TO_DATE('2025-05-09', 'YYYY-MM-DD'));
INSERT INTO THANH_TOAN VALUES ('TT002', 'D002', 'MOMO', 60000, TO_DATE('2025-05-09', 'YYYY-MM-DD'));
INSERT INTO THANH_TOAN VALUES ('TT003', 'D003', 'TIEN_MAT', 90000, TO_DATE('2025-05-09', 'YYYY-MM-DD'));
INSERT INTO THANH_TOAN VALUES ('TT004', 'D004', 'ZALO_PAY', 120000, TO_DATE('2025-05-09', 'YYYY-MM-DD'));
INSERT INTO THANH_TOAN VALUES ('TT005', 'D005', 'VISA', 90000, TO_DATE('2025-05-09', 'YYYY-MM-DD'));

INSERT INTO NHANVIEN VALUES ('NV01', 'Ngô Văn Quân', 'nv1@cinema.vn', '0900000001', 'admin123', 'ADMIN');
INSERT INTO NHANVIEN VALUES ('NV02', 'Phạm Thị Mai', 'nv2@cinema.vn', '0900000002', 'staff123', 'NHAN_VIEN');
INSERT INTO NHANVIEN VALUES ('NV03', 'Lê Quốc Hùng', 'nv3@cinema.vn', '0900000003', 'staff234', 'NHAN_VIEN');
INSERT INTO NHANVIEN VALUES ('NV04', 'Võ Minh Thư', 'nv4@cinema.vn', '0900000004', 'staff345', 'NHAN_VIEN');
INSERT INTO NHANVIEN VALUES ('NV05', 'Đặng Hải Yến', 'nv5@cinema.vn', '0900000005', 'staff456', 'ADMIN');

INSERT INTO CHI_TIET_DAT_CHO VALUES ('D001', 'A1', 60000); -- THUONG
INSERT INTO CHI_TIET_DAT_CHO VALUES ('D002', 'A2', 60000); -- THUONG
INSERT INTO CHI_TIET_DAT_CHO VALUES ('D003', 'A3', 90000); -- VIP
INSERT INTO CHI_TIET_DAT_CHO VALUES ('D004', 'A4', 120000); -- DOI
INSERT INTO CHI_TIET_DAT_CHO VALUES ('D005', 'A5', 90000); -- VIP